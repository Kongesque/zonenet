<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZoneNet</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='img/favicon.png') }}">
</head>

<body class="bg-black text-white font-sans">

    <div id="loading" class="loading-overlay">
        <img src="">
        <p></p>
        <span></span>
    </div>

    <header id="content" class="flex justify-between items-center py-4 px-6 border-b border-gray-500">
        <a href="{{ url_for('main') }}" class="no-underline">
            <div class="text-lg font-semibold text-white tracking-tight">ZoneNet</div>
        </a>
        <a href="{{ url_for('media_file', filename='outputs/' + 'output_' + taskID + '.mp4') }}" download>
            <button class="btn-primary">Download</button>
        </a>
    </header>

    <main id="content" class="flex items-center justify-center p-6">
        <div class="flex w-full h-[calc(100vh-140px)]">
            <video class="rounded-xl w-full object-contain bg-gray-600" controls>
                <source src="{{ url_for('media_file', filename='outputs/' + 'output_' + taskID + '.mp4') }}"
                    type="video/mp4">
            </video>
        </div>
    </main>

    <footer id="content" class="flex justify-between items-center py-4 px-6 border-t border-gray-500">
        <div class="flex gap-6 text-sm text-gray-300">
            <p class="size-width">
                <span>Width: </span>
                <span class="value text-white"> - px</span>
            </p>
            <p class="size-height">
                <span>Height: </span>
                <span class="value text-white"> - px</span>
            </p>
        </div>
        <div class="flex items-center gap-3">
            <form id="uploadForm" method='POST' enctype="multipart/form-data" hidden>
                {{ form.hidden_tag() }}
                <div class="custom-file">
                    {{ form.file(class_="custom-file-input", id="fileInput", accept="video/*") }}
                    <label class="custom-file-label" for="customFile">New Upload file</label>
                </div>
                <input id="dummy" type="submit" name="anything_submit" value="Submit" onclick="loading();" hidden>
            </form>

            <span class="text-sm text-gray-300">New upload</span>
            <button
                class="upload w-10 h-10 flex items-center justify-center bg-white rounded-lg hover:bg-gray-200 transition-all">
                <img src="{{ url_for('static', filename='img/upload.svg') }}" class="w-5 h-5">
            </button>
        </div>
    </footer>

    <script src="{{url_for('static', filename='script/result.js')}}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        var image = new Image();
        image.src = "{{ url_for('media_file', filename='frames/' + 'frame_' + taskID + '.jpg') }}";
        image.onload = function () {
            document.querySelector(".size-width .value").textContent = this.naturalWidth + " px";
            document.querySelector(".size-height .value").textContent = this.naturalHeight + " px";
        };

        $(document).ready(function () {
            $('#loading').hide();
        });

        function loading() {
            $("header#content").hide();
            $("main#content").hide();
            $("footer#content").hide();
            $("#loading").show();
            $("#loading img").attr("src", "{{ url_for('static', filename='img/cow.gif') }}");
            $("#loading p").text("Uploading files...");
            $("#loading span").html("The process may take a moment, please<br>keep this window open.");
        };
    </script>
</body>

</html>